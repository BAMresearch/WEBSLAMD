{% from 'action_buttons.html' import create_change_selection_button -%}

<h3 class="mt-3">Materials formulations</h3>
<form action="" method="post" novalidate>
    {{ materials_and_processes_selection_form.csrf_token }}

    <div class="col-12 rounded mb-3 bg-white" role="tooltip">
        <h3 class="explanation-header">How to create and submit new formulations</h3>
        <div class="explanation-body">
            Select various materials / processes as well as a weight constraint and name in the selection boxes below.
            Having configured the form, set weight ratios in terms of minimal and maximal values of each material and
            the
            increments which define the step size from minimal to maximal value.
            The weights of aggregates are automatically determined by the weight constraint and the weights of the other
            materials.
            Note that the created mixtures can still be edited after submitting the weight form. With the given mixture
            a material formulation batch
            can be created. Doing the process over again, until all batches of the formulation are created, you may now
            submit
            the formulation thus creating a dataset to be used in materials discovery.
        </div>
    </div>

    <div class="row g-3 mb-3 align-items-end">
        <div class="col-md-6">
            {{ materials_and_processes_selection_form.powder_selection.label(class_="control-label") }}
            {{ materials_and_processes_selection_form.powder_selection(class_="form-control form-select
            multiple-select-md") }}
        </div>
        <div class="col-md-6">
            {{ materials_and_processes_selection_form.liquid_selection.label(class_="control-label") }}
            {{ materials_and_processes_selection_form.liquid_selection(class_="form-control form-select
            multiple-select-md") }}
        </div>
    </div>
    <div class="row g-3 mb-3 align-items-end">
        <div class="col-md-6">
            {{ materials_and_processes_selection_form.aggregates_selection.label(class_="control-label") }}
            {{ materials_and_processes_selection_form.aggregates_selection(class_="form-control form-select
            multiple-select-md") }}
        </div>
        <div class="col-md-6">
            {{ materials_and_processes_selection_form.admixture_selection.label(class_="control-label") }}
            {{ materials_and_processes_selection_form.admixture_selection(class_="form-control form-select
            multiple-select-md") }}
        </div>
    </div>
    <div class="row g-3 mb-3 align-items-end">
        <div class="col-md-6">
            {{ materials_and_processes_selection_form.custom_selection.label(class_="control-label") }}
            {{ materials_and_processes_selection_form.custom_selection(class_="form-control form-select
            multiple-select-md") }}
        </div>
        <div class="col-md-6">
            {{ materials_and_processes_selection_form.process_selection.label(class_="control-label") }}
            {{ materials_and_processes_selection_form.process_selection(class_="form-control form-select
            multiple-select-md") }}
        </div>
    </div>
    <div class="row g-3 mb-3 align-items-end">
        <div class="col-md-6">
            {{ materials_and_processes_selection_form.weight_constraint.label(class_="control-label") }}
            {{ materials_and_processes_selection_form.weight_constraint(class_="form-control") }}
        </div>
        <div class="col-md-6">
            {{ materials_and_processes_selection_form.dataset_name.label(class_="control-label") }}
            {{ materials_and_processes_selection_form.dataset_name(class_="form-control") }}
        </div>
    </div>

    {{ create_change_selection_button("4 - Configure weights for each material type",
    "change_materials_and_processes_selection_button",
    "confirm_materials_and_processes_selection_button",
    "Specify at least one powder, one liquid, one aggregate, and a constraint to create materials formulations") }}

    <div id="formulations_min_max_placeholder"></div>

    <div id="formulations_weights_placeholder"></div>

    <div class="row g-3 mb-3 align-items-end">
        <div class="col-md-6">
            <button class="btn btn-danger col-12 mb-3" type="button" id="delete_formulations_batches_button"
                data-bs-toggle="tooltip" data-bs-placement="bottom" disabled
                title="Deletes all batches created so far. In case you want to save as a dataset, click on Submit Dataset button.">
                Delete Material Formulation
            </button>
        </div>
        <div class="col-md-6">
            {{ materials_and_processes_selection_form.submit(class_="btn btn-primary col-12 mb-3",
            data_bs_toggle="tooltip", data_bs_placement="bottom",
            title="Save your created formulation as a dataset to be used for materials discovery. Specify any name but
            'temporary' for the dataset.", disabled=True) }}
        </div>
    </div>

</form>